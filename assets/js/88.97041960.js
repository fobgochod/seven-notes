(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{532:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"socket编程bio及tcp参数"}},[s._v("Socket编程BIO及TCP参数")]),s._v(" "),t("h4",{attrs:{id:"基础命令"}},[s._v("基础命令")]),s._v(" "),t("ul",[t("li",[s._v("lsof -p")]),s._v(" "),t("li",[s._v("netstat -natp")]),s._v(" "),t("li",[s._v("tcpdump")])]),s._v(" "),t("h4",{attrs:{id:"server"}},[s._v("Server")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译启动服务端")]),s._v("\njavac SocketIOPropertites.java "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" SocketIOPropertites \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网络状况")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-natp")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看java进程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("lsof")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-op")]),s._v(" java-pid\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开TCP监控")]),s._v("\ntcpdump "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-nn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" eth0 port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h4",{attrs:{id:"client"}},[s._v("Client")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("javac SocketClient.java "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" SocketClient\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("socket 四元组 CIP CPORT + SIP SPORT 内核级的")]),s._v(" "),t("ul",[t("li",[s._v("ifconfig")]),s._v(" "),t("li",[s._v("MTU(Maximum Transmission Unit) 1500bytes 总数据包大小 1500字节")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@seven ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ifconfig")]),s._v("\neth0: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flags")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("416")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("UP,BROADCAST,RUNNING,MULTICAST"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v("\ninet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.19")]),s._v(".231.255  netmask "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".240.0  broadcast "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.19")]),s._v(".239.255\nether 00:16:3e:02:ce:8a  txqueuelen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Ethernet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nRX packets "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("37642950")]),s._v("  bytes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7411002555")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.9")]),s._v(" GiB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nRX errors "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  overruns "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  frame "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nTX packets "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34207365")]),s._v("  bytes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21628623014")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.1")]),s._v(" GiB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTX errors "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" overruns "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  carrier "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  collisions "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ul",[t("li",[s._v("tcpdump -nn -i eth0 port 9090")]),s._v(" "),t("li",[s._v("mms 数据内容大小")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@seven ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tcpdump -nn -i eth0 port 9090")]),s._v("\ntcpdump: verbose output suppressed, use "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-vv")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" full protocol decode\nlistening on eth0, link-type EN10MB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Ethernet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", capture size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),s._v(" bytes\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":42:29.910181 IP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("117.65")]),s._v(".156.171.30077 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.19")]),s._v(".231.255.9090: Flags "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("S"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("83533905")]),s._v(", win "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64240")]),s._v(", options "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mss "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1400")]),s._v(",nop,wscale "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(",nop,nop,sackOK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", length "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":42:29.910219 IP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.19")]),s._v(".231.255.9090 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("117.65")]),s._v(".156.171.30077: Flags "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("S."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3044535540")]),s._v(", ack "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("83533906")]),s._v(", win "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1152")]),s._v(", options "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mss "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1460")]),s._v(",nop,nop,sackOK,nop,wscale "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", length "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":42:29.925693 IP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("117.65")]),s._v(".156.171.30077 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.19")]),s._v(".231.255.9090: Flags "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", ack "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", win "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("257")]),s._v(", length "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("nc 47.100.125.75 9090")]),s._v(" "),t("h2",{attrs:{id:"网络io-变化-模型"}},[s._v("网络IO 变化 模型")]),s._v(" "),t("p",[s._v("同步 异步 阻塞 非阻塞")]),s._v(" "),t("ul",[t("li",[s._v("同步阻塞")]),s._v(" "),t("li",[s._v("同步非阻塞")]),s._v(" "),t("li",[s._v("异步非阻塞")])]),s._v(" "),t("p",[s._v("strace -ff -o out -cmd")]),s._v(" "),t("p",[s._v("man tcp\nman ip\nman 7 ip\nman ascii\nman utf-8\nman bash\nman man\nman 2 socket")]),s._v(" "),t("h3",{attrs:{id:"bio"}},[s._v("BIO")])])}),[],!1,null,null,null);t.default=e.exports}}]);